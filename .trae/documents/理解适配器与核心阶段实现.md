# 理解适配器与核心阶段实现

我将为您详细讲解适配器模式在系统中的作用，并梳理引导、确认、执行三个核心阶段的代码实现。

## 1. 适配器 (Agent Adapter) 的作用
- **核心概念**: 就像电源转接头，把不同形状的插头（各个具体的 Agent）转换成统一的插座（系统标准接口）。
- **为什么需要**: 系统里的 PlanAgent, GuideAgent, EditorAgent 可能写法各不相同，Orchestrator（调度器）不想管这些细节，只想用统一的方法调用它们。
- **图解**: 我会画一个形象的图来解释这个转换过程。

## 2. 核心阶段代码梳理 (分块讲解)
我将把代码像切蛋糕一样切开，告诉您每一块蛋糕在哪一行。

### 阶段一：引导阶段 (GUIDING)
- **目标**: 和用户聊天，生成草稿。
- **关键代码**: 
    - `api.py`: 接收用户输入。
    - `orchestrator.py`: 调用 Agent。
    - `agent_adapters.py`: 处理 Agent 返回的 `WAIT_INPUT` 或 `PROPOSE_DRAFT`。

### 阶段二：确认阶段 (CONFIRMING)
- **目标**: 用户看草稿，决定要不要用。
- **关键代码**:
    - `agent_adapters.py`: Agent 发出 `REQUEST_CONFIRM` 信号。
    - `api.py`: 捕获信号，暂停流程，等待 `/confirm` 接口被调用。

### 阶段三：执行阶段 (EDITING)
- **目标**: 真的去改简历数据。
- **关键代码**:
    - `api.py`: 用户调 `/confirm` 接口。
    - `orchestrator.py`: 调度 Editor Agent。
    - `editor_agent.py`: 执行 JSON 修改。

## 交付形式
- **适配器图解**: 形象展示 Adapter 模式。
- **阶段映射表**: 清晰列出每个阶段对应的文件和行号范围。
- **流程图**: 串联三个阶段的宏观流转。
